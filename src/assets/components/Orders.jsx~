import React, { useEffect, useState } from 'react';
import '../scss/orders.scss';
import '../scss/order.scss';
import img from '../img/ordersImg.png';
import Order from './Order';
import useOrders from "../../hooks/useOrders.jsx";

export default function Orders() {
  const { orders: allOrders } = useOrders();

  const [Jarayonda, setJarayonda] = useState([]);
  const [Yetkazib, setYetkazib] = useState([]);
  const [Bekor, setBekor] = useState([]);

  useEffect(() => {
    if (allOrders?.results) { // Проверяем, что results существует
      setJarayonda(allOrders.results.filter((order) => order.status === 'Jarayonda'));
      setYetkazib(allOrders.results.filter((order) => order.status === 'Yetkazib berildi'));
      setBekor(allOrders.results.filter((order) => order.status === 'Bekor qilindi'));
    }
  }, [allOrders]);

  return (
      <div className='orders'>
          { Jarayonda.length > 0 &&
              <>
                  <h2 className='order__status-header'>Jarayonda</h2>
                  {Jarayonda.map((order) => (
                      <Order order={order} key={order.id} />
                  ))}
              </>
          }

          {
              Yetkazib.length > 0 &&
              <>
                  <h2 className='order__status-header'>Yetkazib berildi</h2>
                  {Yetkazib.map((order) => (
                      <Order order={order} key={order.id} />
                  ))}
              </>
          }

          {
              Bekor.length > 0 &&
              <>
                  <h2 className='order__status-header'>Bekor qilindi</h2>
                  {Bekor.map((order) => (
                      <Order order={order} key={order.id} />
                  ))}
              </>
          }
      </div>
  );
}
